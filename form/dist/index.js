"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),a=require("react-redux"),t=require("react-hook-form"),l=require("react-select"),n=require("react-select/async"),o=require("react-phone-input-2"),r=require("primereact/inputtext"),s=require("primereact/password"),i=require("primereact/inputtextarea"),u=require("primereact/checkbox"),c=require("primereact/inputswitch"),d=require("primereact/slider"),m=require("primereact/calendar"),f=require("primereact/chips"),p=require("primereact/button"),g=require("primereact/editor"),h=require("primereact/utils"),C=require("sami-modal"),v=require("axios");function E(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var y=E(e),N=E(l),b=E(n),S=E(o),w=E(v);function A(){return A=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},A.apply(this,arguments)}const O=process.env;let q={};try{q.placesAutoCompleteURI=O.REACT_APP_PLACES_AUTOCOMPLETE_URI||"https://us-central1-hfn-registration-qa.cloudfunctions.net/",q.srcmStaticDataURI=O.REACT_APP_STATIC_DATA_SRCM_URI||"https://static-gatsby-qa.web.app/srcmapi/",q.gPlacesSession=O.REACT_APP_GPLACES_SESSION_KEY||"74c576ef-7234-4f47-8b11-f8e41d247f3b"}catch{q.placesAutoCompleteURI="https://us-central1-hfn-registration-qa.cloudfunctions.net/",q.srcmStaticDataURI="https://static-gatsby-qa.web.app/srcmapi/",q.gPlacesSessionKey="74c576ef-7234-4f47-8b11-f8e41d247f3b"}const k=w.default.create({baseURL:q.placesAutoCompleteURI}),x=w.default.create({baseURL:q.srcmStaticDataURI});class P{getCachedCitySuggestions(e){return x.get(`cities/${e}.json`)}getCachedStateSuggestions(e){return x.get(`states/${e}.json`)}getCachedCountrySuggestions(){return x.get("countries/all.json")}getGPlaceSuggestions(e){return k.get("gplaces",{params:{session:q.gPlacesSessionKey,input:e}})}}const R=({name:e,state:a,country:t},{context:l})=>"menu"===l?y.default.createElement("div",{className:"cac-wrapper"},y.default.createElement("div",{className:"cac-name"},e),y.default.createElement("div",{className:"cac-sc-wrapper"},y.default.createElement("span",{className:"cac-sc"},a,a?y.default.createElement("span",null," , "):y.default.createElement(y.default.Fragment,null),t))):e?e+(a?", "+a:"")+(t?", "+t:""):null,I=async(e,a)=>{const t=e?e.trim().toLowerCase():null;let l=[];if(t){const e=new P;let a;try{a=await e.getCachedCitySuggestions(t[0]);let n=a.data.results;for(const e of n)if(e.active&&e.name.toLowerCase().startsWith(t)&&(l.push({...e,value:e.id,label:e.name}),20===l.length))break;if(0===l.length)try{a=await e.getGPlaceSuggestions(t),l=a.data}catch{console.log("Something went wong.")}}catch{try{a=await e.getGPlaceSuggestions(t),l=a.data}catch{console.log("Something went wong.")}}}a(l||[])},L=async(e,a)=>{const t=e?e.trim().toLowerCase():null;let l=[];if(t){const e=new P;let a;try{a=await e.getCachedStateSuggestions(t[0]);let n=a.data.results;for(const e of n)if(e.active&&e.name.toLowerCase().startsWith(t)&&(l.push({...e,value:e.id,label:e.name}),20===l.length))break;if(0===l.length)try{a=await e.getGPlaceSuggestions(t),l=a.data.map((e=>({...e,value:e.state_id,label:e.state})))}catch{console.log("Something went wong.")}}catch{try{a=await e.getGPlaceSuggestions(t),l=a.data.map((e=>({...e,value:e.state_id,label:e.state})))}catch{console.log("Something went wong.")}}}a(l||[])},F=async(e,a)=>{const t=e?e.trim().toLowerCase():null;let l=[];if(t){const e=new P;let a;try{a=await e.getCachedCountrySuggestions(t[0]);let n=a.data.results;for(const e of n)if(e.active&&e.name.toLowerCase().startsWith(t)&&(l.push({...e,value:e.id,label:e.name}),20===l.length))break;if(0===l.length)try{a=await e.getGPlaceSuggestions(t),l=a.data.map((e=>({...e,value:e.country_id,label:e.country})))}catch{console.log("Something went wong.")}}catch{try{a=await e.getGPlaceSuggestions(t),l=a.data.map((e=>({...e,value:e.country_id,label:e.country})))}catch{console.log("Something went wong.")}}}a(l||[])};exports.default=({initialValues:l,fields:n,onFormSubmit:o,submitButtonGroup:v,formConfig:E})=>{const w=y.default.createElement("div",{className:"form-button-group"},y.default.createElement(p.Button,{type:"button",className:"p-button p-button-secondary p-mr-2",label:"Cancel",onClick:()=>{C.modal.toggle(!1)}}," "),y.default.createElement(p.Button,{type:"submit",label:"Submit",className:"p-button p-button-primary"})),{register:O,handleSubmit:q,formState:{errors:k,isSubmitted:x},control:P,setValue:V,getValues:_}=t.useForm();e.useEffect((()=>{Object.keys(l).forEach((e=>{V(e,l[e],{shouldValidate:!0,shouldDirty:!0})}))}),[]);const T=a.useSelector((e=>e.dropdown));return y.default.createElement("form",{onSubmit:q((e=>{o(e,k)})),className:`form-wrapper ${E?E.formClassName:""}`,autoComplete:`${E?E.autoComplete:"on"}`},y.default.createElement("div",{className:`p-fluid form-section p-d-flex p-flex-wrap ${E?E.formSectionClassName:""}`},Object.keys(n).map(((e,a)=>{const{properties:l}=n[e];let o,p;if(o=l.primeFieldProps?l.primeFieldProps:{},l.validations)if("function"==typeof l.validations.validate){const e=e=>l.validations.validate(e,_);p={...l.validations,validate:e}}else p=l.validations;else p={};return!1===l.visibility?y.default.createElement(y.default.Fragment,{key:e}):y.default.createElement(y.default.Fragment,{key:e},y.default.createElement("div",{className:`p-field-wrapper p-col-12 ${l.fieldWrapperClassNames?l.fieldWrapperClassNames:""}`,key:e+a},-1===["Checkbox"].indexOf(l.type)?y.default.createElement("label",{htmlFor:"lastname1",className:`p-field-label ${l.fieldLabelClassNames?l.fieldLabelClassNames:""}`},p&&p.required&&p.required.value?y.default.createElement("em",null,"* "):y.default.createElement(y.default.Fragment,null),l.label,l.tooltip?y.default.createElement("span",{className:"tooltip-icon",title:l.tooltip}," ",y.default.createElement("i",{className:"uil uil-info-circle"})," "):y.default.createElement(y.default.Fragment,null)):null,y.default.createElement("div",{className:`p-field-section ${l.fieldSectionClassNames?l.fieldSectionClassNames:""}`},(()=>{switch(l.type){case"InputText":return y.default.createElement(r.InputText,A({},o,{className:h.classNames({"p-invalid":k[e]}),name:e},O(e,p)));case"Password":return y.default.createElement(s.Password,A({},o,{className:h.classNames({"p-invalid":k[e]}),name:e},O(e,p)));case"InputTextarea":return y.default.createElement(i.InputTextarea,A({},o,{className:h.classNames({"p-invalid":k[e]}),name:e},O(e,p)));case"Select":return y.default.createElement(t.Controller,{control:P,rules:p,name:e,defaultValue:null,render:({field:{onChange:a,value:t,name:n,ref:r}})=>y.default.createElement(N.default,A({className:h.classNames({"p-invalid":k[e]}),noOptionsMessage:()=>"No data found"},o,{name:n,value:t,onChange:e=>{a(e),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,V,x)},options:l.dropdownOptions&&Array.isArray(T[l.dropdownOptions])?T[l.dropdownOptions]:o.options||[],inputRef:r}))});case"MultiSelect":return y.default.createElement(t.Controller,{control:P,rules:p,name:e,defaultValue:null,render:({field:{onChange:a,value:t,name:n,ref:r}})=>y.default.createElement(N.default,A({className:h.classNames({"p-invalid":k[e]}),closeMenuOnSelect:!1,noOptionsMessage:()=>"No data found"},o,{name:n,value:t,isMulti:!0,onChange:e=>{a(e),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,V,x)},options:l.dropdownOptions&&Array.isArray(T[l.dropdownOptions])?T[l.dropdownOptions]:o.options||[],inputRef:r}))});case"AutoComplete":return y.default.createElement(t.Controller,{control:P,rules:p,name:e,defaultValue:null,render:({field:{onChange:a,value:t,name:n,ref:r}})=>y.default.createElement(b.default,A({className:h.classNames({"p-invalid":k[e]}),noOptionsMessage:()=>"No data found"},o,{name:n,value:t,autoComplete:"off",loadOptions:(e,a)=>{((e,a,t,l,n,o)=>{try{e.length>2&&t[l](e).then((e=>{let t=[],l=[];e&&e.data&&(Array.isArray(e.data)?l=e.data:Array.isArray(e.data.data)&&(l=e.data.data),t=l.map((e=>({...e,label:e[n],value:e[o]})))),a(t)}))}catch{a([]),console.log("Something went wrong.")}})(e,a,l.service,l.method,o.optionLabel||"name",o.optionValue||"id")},onChange:e=>{a(e),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,V,x)},inputRef:r}))});case"CityAutoComplete":return y.default.createElement(t.Controller,{control:P,rules:p,name:e,defaultValue:null,render:({field:{onChange:a,value:t,name:l,ref:n}})=>y.default.createElement(b.default,A({className:h.classNames({"p-invalid":k[e]}),noOptionsMessage:()=>"No data found",optionLabel:"name",optionValue:"id",formatOptionLabel:R},o,{name:l,value:t,autoComplete:"off",loadOptions:I,onChange:e=>{a(e),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,V,x)},inputRef:n}))});case"StateAutoComplete":return y.default.createElement(t.Controller,{control:P,rules:p,name:e,defaultValue:null,render:({field:{onChange:a,value:t,name:l,ref:n}})=>y.default.createElement(b.default,A({className:h.classNames({"p-invalid":k[e]}),noOptionsMessage:()=>"No data found",optionLabel:"name",optionValue:"id"},o,{name:l,value:t,autoComplete:"off",loadOptions:L,onChange:e=>{a(e),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,V,x)},inputRef:n}))});case"CountryAutoComplete":return y.default.createElement(t.Controller,{control:P,rules:p,name:e,defaultValue:null,render:({field:{onChange:a,value:t,name:l,ref:n}})=>y.default.createElement(b.default,A({className:h.classNames({"p-invalid":k[e]}),noOptionsMessage:()=>"No data found",optionLabel:"name",optionValue:"id"},o,{name:l,value:t,autoComplete:"off",loadOptions:F,onChange:e=>{a(e),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,V,x)},inputRef:n}))});case"Checkbox":return y.default.createElement("div",null,y.default.createElement(t.Controller,{name:e,control:P,rules:p,render:a=>y.default.createElement(u.Checkbox,A({className:h.classNames({"p-invalid":k[e]})},o,{inputId:e,onChange:e=>{a.field.onChange(e.checked),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,V)},checked:a.field.value}))}),y.default.createElement("label",{htmlFor:e,className:`p-pl-2 p-checkbox-label ${l.fieldLabelClassNames?l.fieldLabelClassNames:""}`},p&&p.required&&p.required.value?y.default.createElement("em",null,"* "):y.default.createElement(y.default.Fragment,null),l.label,l.tooltip?y.default.createElement("span",{className:"tooltip-icon",title:l.tooltip}," ",y.default.createElement("i",{className:"uil uil-info-circle"})," "):y.default.createElement(y.default.Fragment,null)));case"RadioButton":if(l.items)return l.items.map((a=>y.default.createElement("div",{key:a.key,className:"p-field-radiobutton"},y.default.createElement(t.Controller,{className:h.classNames({"p-invalid":k[e]}),name:e,control:P,rules:p,render:t=>y.default.createElement("input",A({type:"radio",id:a.key,value:a.key,name:e},o,{onClick:e=>{t.field.onChange(e.target.value),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,V)}}))}),y.default.createElement("label",{htmlFor:a.key},a.name))));break;case"InputSwitch":return y.default.createElement("div",null,y.default.createElement(t.Controller,{name:e,control:P,rules:p,render:a=>y.default.createElement(c.InputSwitch,A({},o,{inputId:e,onChange:e=>{a.field.onChange(e.value),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,V)},checked:a.field.value}))}));case"FileUpload":if(!p.validate){let e=l.maxFileSize;if(e){let a=l.fileSizeError||"Selected file size is greater than allowed file size";p.validate=t=>!(Array.isArray(t)&&t[0]&&t[0].size&&t[0].size>1024*e*1024)||a}}return y.default.createElement(r.InputText,A({className:h.classNames({"p-invalid":k[e]}),type:"file"},o,{name:e},O(e,p)));case"Slider":return y.default.createElement("div",null,y.default.createElement(d.Slider,A({},o,{onSlideEnd:a=>{V(e,a.value)}})),y.default.createElement(r.InputText,A({type:"hidden",name:e},O(e,p))));case"Calendar":return y.default.createElement(t.Controller,{control:P,rules:p,name:e,defaultValue:null,render:a=>y.default.createElement(m.Calendar,A({className:h.classNames({"p-invalid":k[e]})},o,{name:a.field.name,value:a.field.value,onChange:e=>{a.field.onChange(e.value),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,V)},optionLabel:"label",optionValue:"value",inputRef:a.field.ref}))});case"Chips":return y.default.createElement("div",null,y.default.createElement(t.Controller,{name:e,control:P,rules:p,render:a=>y.default.createElement(f.Chips,{className:h.classNames({"p-invalid":k[e]}),onChange:e=>{a.field.onChange(e.value),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,V)}})}),y.default.createElement("label",{htmlFor:e,className:"p-checkbox-label"},l.label));case"PhoneInput":return y.default.createElement(t.Controller,{control:P,rules:p,name:e,defaultValue:null,render:a=>y.default.createElement(S.default,A({className:h.classNames({"p-invalid":k[e]}),country:"in",value:a.field.value,name:a.field.name},o,{onChange:(e,t,l,n)=>{a.field.onChange(n),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e,t,l,n,V)},inputRef:a.field.ref}))});case"RichTextEditor":return y.default.createElement(t.Controller,{control:P,rules:p,name:e,defaultValue:null,render:({field:{onChange:a,value:t,name:l,ref:n}})=>y.default.createElement(g.Editor,A({className:h.classNames({"p-invalid":k[e]}),style:{height:"165px"},value:t,name:l},o,{onTextChange:e=>{console.log(e),a(e.htmlValue),o&&o.onChange&&"function"==typeof o.onChange&&o.onChange(e.htmlValue,e,V,x)},inputRef:n}))});default:return y.default.createElement(y.default.Fragment,null,"Form field not available")}})()),y.default.createElement("div",{className:`p-error-section ${l.fieldErrorClassNames?l.fieldErrorClassNames:""}`},k[e]&&y.default.createElement("span",{role:"alert",className:"error"}," ",k[e].message," ")),l.hint?y.default.createElement("div",{className:`p-hint-section ${l.fieldHintClassNames?l.fieldHintClassNames:""}`},l.hint):y.default.createElement(y.default.Fragment,null)))}))),v&&"function"==typeof v?v():w)};
